Customer Lifetime Value Analysis
-This query is used to calculate the total sales and total profit generated by each customer over their entire transaction history-Purpose of the query
-Understand long-term customer value
-Identify high-profit customers
-Support customer segmentation and retention analysis

WITH customer_lifetime AS (
    SELECT
        customer_id,
        SUM(sales) AS lifetime_sales,
        SUM(profit) AS lifetime_profit
    FROM sales
    GROUP BY customer_id
)
SELECT distinct
    c.customer_name,
    cl.lifetime_sales,
    cl.lifetime_profit
FROM customer_lifetime cl
JOIN customer c
ON cl.customer_id = c.customer_id
ORDER BY cl.lifetime_profit DESC;

How the query works
-Creates a temporary result set that aggregates all sales transactions by customer
-Calculates lifetime sales and lifetime profit for each customer
-Joins the aggregated sales data with the customer table
-Retrieves customer names for better readability and reporting
-Sorts customers from highest to lowest lifetime profit
-Helps identify the most valuable customers

Why this analysis is useful
-Highlights customers who contribute the most to profitability
-Supports business decisions such as loyalty programs and targeted marketing
